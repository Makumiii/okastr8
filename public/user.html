<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Users - okastr8</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>ğŸ‘¤ User Management</h1>
            <span id="auth-status" class="auth-status">Checking...</span>
        </header>

        <a href="index.html" class="back-link">â† Back to Dashboard</a>

        <div class="form-grid">
            <!-- Create User -->
            <div class="form-container">
                <h3>â• Create User</h3>
                <form id="create-user-form">
                    <input type="text" name="username" placeholder="Username" required>
                    <input type="password" name="password" placeholder="Password" required>
                    <button type="submit">Create User</button>
                </form>
            </div>

            <!-- Delete User -->
            <div class="form-container">
                <h3>ğŸ—‘ï¸ Delete User</h3>
                <form id="delete-user-form">
                    <input type="text" name="username" placeholder="Username" required>
                    <button type="submit" class="btn-danger">Delete User</button>
                </form>
            </div>

            <!-- Last Login -->
            <div class="form-container">
                <h3>ğŸ• Last Login</h3>
                <form id="last-login-form">
                    <input type="text" name="username" placeholder="Username" required>
                    <button type="submit">Check Last Login</button>
                </form>
            </div>

            <!-- List Groups -->
            <div class="form-container">
                <h3>ğŸ‘¥ List User's Groups</h3>
                <form id="list-groups-form">
                    <input type="text" name="username" placeholder="Username" required>
                    <button type="submit">List Groups</button>
                </form>
            </div>

            <!-- Lock User -->
            <div class="form-container">
                <h3>ğŸ”’ Lock User</h3>
                <form id="lock-user-form">
                    <input type="text" name="username" placeholder="Username" required>
                    <button type="submit" class="btn-secondary">Lock User</button>
                </form>
            </div>

            <!-- List Users -->
            <div class="form-container">
                <h3>ğŸ“‹ List All Users</h3>
                <button type="button" id="list-users-btn">List Users</button>
            </div>
        </div>

        <!-- Results Display -->
        <div id="user-results" class="results-display"></div>
    </div>

    <script src="js/common.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const result = createResultDisplay('user-results');

            // Form handlers
            const forms = [
                { id: 'create-user-form', endpoint: '/user/create' },
                { id: 'delete-user-form', endpoint: '/user/delete' },
                { id: 'last-login-form', endpoint: '/user/last-login' },
                { id: 'list-groups-form', endpoint: '/user/list-groups' },
                { id: 'lock-user-form', endpoint: '/user/lock' },
            ];

            forms.forEach(({ id, endpoint }) => {
                const form = document.getElementById(id);
                if (form) {
                    handleFormSubmit(form, endpoint, result);
                }
            });

            // List users button
            document.getElementById('list-users-btn').addEventListener('click', async () => {
                result.showLoading();
                try {
                    const res = await apiGet('/user/list-users');
                    if (res.success) {
                        result.showData(res.message, 'System Users');
                    } else {
                        result.showError(res.message);
                    }
                } catch (e) {
                    e.message === 'UNAUTHORIZED' ? result.showUnauthorized() : result.showError(e.message);
                }
            });
        });
    </script>
</body>

</html>