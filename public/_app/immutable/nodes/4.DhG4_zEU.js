import{c as se,a as o,d as Te,f as p,s as P,t as fe}from"../chunks/BesHKk2l.js";import{o as Ve}from"../chunks/CMSYLF-L.js";import{f,p as Ie,s as T,a as Ge,t as D,b as Ee,c as d,e as t,d as r,r as a,g as s,n as M,u as Oe}from"../chunks/DcwGHiHW.js";import{l as oe,s as ne,a as qe,i as F,b as Ue}from"../chunks/VPZc6XJw.js";import{e as Xe,i as Je}from"../chunks/D9-Fv5Cr.js";import{p as Ke}from"../chunks/DPLqBrji.js";import{B as V}from"../chunks/7OBOsxqh.js";import{C as ae}from"../chunks/CcxZSFxj.js";import{p as re,g as Qe,B as me}from"../chunks/BhjZa1Ej.js";import{t as I}from"../chunks/CgBnaJbM.js";import"../chunks/BlO2upe1.js";import{I as le,s as ie}from"../chunks/BTbKrF2_.js";import{S as We,P as Ye}from"../chunks/BAuDmANa.js";import{G as Ze}from"../chunks/Dyxv6FLw.js";import{X as et,C as tt,R as at}from"../chunks/DdFlPsbk.js";import{T as rt}from"../chunks/9JUkeufA.js";function st(C,h){const A=oe(h,["children","$$slots","$$events","$$legacy"]);const N=[["path",{d:"M12 20v2"}],["path",{d:"M12 2v2"}],["path",{d:"M17 20v2"}],["path",{d:"M17 2v2"}],["path",{d:"M2 12h2"}],["path",{d:"M2 17h2"}],["path",{d:"M2 7h2"}],["path",{d:"M20 12h2"}],["path",{d:"M20 17h2"}],["path",{d:"M20 7h2"}],["path",{d:"M7 20v2"}],["path",{d:"M7 2v2"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1"}]];le(C,ne({name:"cpu"},()=>A,{get iconNode(){return N},children:(j,y)=>{var m=se(),$=f(m);ie($,h,"default",{}),o(j,m)},$$slots:{default:!0}}))}function ot(C,h){const A=oe(h,["children","$$slots","$$events","$$legacy"]);const N=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5"}],["path",{d:"M10 9H8"}],["path",{d:"M16 13H8"}],["path",{d:"M16 17H8"}]];le(C,ne({name:"file-text"},()=>A,{get iconNode(){return N},children:(j,y)=>{var m=se(),$=f(m);ie($,h,"default",{}),o(j,m)},$$slots:{default:!0}}))}function nt(C,h){const A=oe(h,["children","$$slots","$$events","$$legacy"]);const N=[["line",{x1:"6",x2:"6",y1:"3",y2:"15"}],["circle",{cx:"18",cy:"6",r:"3"}],["circle",{cx:"6",cy:"18",r:"3"}],["path",{d:"M18 9a9 9 0 0 1-9 9"}]];le(C,ne({name:"git-branch"},()=>A,{get iconNode(){return N},children:(j,y)=>{var m=se(),$=f(m);ie($,h,"default",{}),o(j,m)},$$slots:{default:!0}}))}function lt(C,h){const A=oe(h,["children","$$slots","$$events","$$legacy"]);const N=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];le(C,ne({name:"refresh-cw"},()=>A,{get iconNode(){return N},children:(j,y)=>{var m=se(),$=f(m);ie($,h,"default",{}),o(j,m)},$$slots:{default:!0}}))}function it(C,h){const A=oe(h,["children","$$slots","$$events","$$legacy"]);const N=[["path",{d:"M10 11v6"}],["path",{d:"M14 11v6"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];le(C,ne({name:"trash-2"},()=>A,{get iconNode(){return N},children:(j,y)=>{var m=se(),$=f(m);ie($,h,"default",{}),o(j,m)},$$slots:{default:!0}}))}const dt=!1,Ut=Object.freeze(Object.defineProperty({__proto__:null,prerender:dt},Symbol.toStringTag,{value:"Module"}));var ct=p('<div class="h-8 w-48 rounded bg-[var(--border)]"></div> <div class="mt-4 h-4 w-64 rounded bg-[var(--border)]"></div>',1),vt=p("<!> ",1),pt=p("<!> ",1),ut=p("<!> ",1),ft=p("<!> Logs",1),mt=p("<!> Restart",1),_t=p("<!> Stop",1),$t=p("<!> Start",1),ht=p("<!> Delete",1),gt=p('<div><h1 class="text-2xl font-bold text-[var(--text-primary)]"> </h1> <div class="mt-2 flex flex-wrap items-center gap-2"><!> <!> <!></div></div> <div class="flex flex-wrap gap-2"><!> <!> <!> <!> <!></div>',1),xt=p('<span class="flex h-8 w-8 items-center justify-center rounded-full bg-[var(--success-light)] text-[var(--success)]"><!></span>'),yt=p('<span class="flex h-8 w-8 items-center justify-center rounded-full bg-[var(--bg-sidebar)] text-[var(--text-muted)]"> </span>'),bt=p('<span class="font-mono"> </span>'),wt=p("<!> Promote",1),Pt=p('<div class="flex items-center gap-4"><!> <div><div class="flex items-center gap-2"><span class="font-medium text-[var(--text-primary)]"> </span> <!></div> <div class="mt-1 flex items-center gap-3 text-xs text-[var(--text-muted)]"><span> </span> <!></div></div></div> <div class="flex items-center gap-2"><!></div>',1),Mt=p('<!> <div><h2 class="mb-4 text-lg font-semibold text-[var(--text-primary)]">Deployments</h2> <div class="space-y-3"><!> <!></div></div>',1),zt=p('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4" role="button" tabindex="0"><div class="max-h-[80vh] w-full max-w-4xl overflow-hidden rounded-[var(--radius-lg)] bg-white shadow-xl" role="document" tabindex="-1"><div class="flex items-center justify-between border-b border-[var(--border)] p-4"><h3 class="text-lg font-semibold text-[var(--text-primary)]"> </h3> <button class="text-[var(--text-muted)] hover:text-[var(--text-primary)]"><!></button></div> <div class="max-h-[60vh] overflow-auto bg-[var(--bg-terminal)] p-4"><pre class="whitespace-pre-wrap font-mono text-sm text-green-400"> </pre></div></div></div>'),kt=p(`<h3 class="flex items-center gap-2 text-lg font-semibold text-[var(--error)]"><!> Confirm Deletion</h3> <p class="mt-2 text-[var(--text-secondary)]">Are you sure you want to delete <strong> </strong>? This
                action cannot be undone.</p> <div class="mt-4 flex justify-end gap-3"><!> <!></div>`,1),Ct=p('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4" role="button" tabindex="0"><!></div>'),At=p('<div class="space-y-6"><div class="flex items-center gap-2 text-sm text-[var(--text-secondary)]"><a href="/apps" class="hover:text-[var(--primary)]">Apps</a> <span>â†’</span> <span class="font-medium text-[var(--text-primary)]"> </span></div> <!></div> <!> <!>',1);function Xt(C,h){Ie(h,!0);const A=()=>qe(Ke,"$page",N),[N,j]=Ue(),y=A().params.name;let m=T(Ge([])),$=T(null),be=T(""),_e=T(!0),z=T(!1),W=T(!1),X=T(!1),ze=T(null);Ve(async()=>{await $e()});async function $e(){d(_e,!0);try{const e=await re("/app/versions",{name:y});if(console.log("Versions API result:",e),e.success&&e.data?.versions){const n=e.data.current;d(m,e.data.versions.map(_=>({id:_.id,deployedAt:_.timestamp,commitHash:_.commit,branch:_.branch,isCurrent:_.id===n})).sort((_,g)=>g.id-_.id),!0)}}catch(e){console.error("Failed to load versions:",e)}try{const e=await Qe("/app/list");console.log("App list API result:",e),e.success&&e.data?.apps&&d($,e.data.apps.find(n=>n.name===y)||null,!0)}catch(e){console.error("Failed to load app list:",e),I.error("Failed to load app data")}d(_e,!1)}async function he(e){d(z,!0);const n=await re(`/app/${e}`,{name:y});n.success?(I.success(`App ${e}ed successfully`),await $e()):I.error(n.message||`Failed to ${e} app`),d(z,!1)}async function ke(e){d(z,!0);const n=await re("/app/rollback",{name:y,versionId:e});n.success?(I.success("Version promoted successfully"),await $e()):I.error(n.message||"Failed to promote version"),d(z,!1)}async function Ce(){const e=await re("/app/logs",{name:y,lines:100});e.success?(d(be,e.message||"No logs available",!0),d(W,!0)):I.error("Failed to load logs")}async function Ae(){d(z,!0);const e=await re("/app/delete",{name:y});e.success?(I.success("App deleted"),window.location.href="/apps"):I.error(e.message||"Failed to delete app"),d(z,!1),d(X,!1)}function Ne(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}var we=At(),ge=f(we),xe=t(ge),Pe=r(t(xe),4),je=t(Pe,!0);a(Pe),a(xe);var De=r(xe,2);{var Fe=e=>{ae(e,{class:"animate-pulse p-8",children:(n,_)=>{var g=ct();M(2),o(n,g)},$$slots:{default:!0}})},He=e=>{var n=Mt(),_=f(n);ae(_,{class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:(w,u)=>{var B=gt(),x=f(B),O=t(x),J=t(O,!0);a(O);var H=r(O,2),q=t(H);{var R=i=>{me(i,{variant:"outline",class:"flex gap-1 items-center",children:(k,c)=>{var v=vt(),L=f(v);nt(L,{size:14});var l=r(L);D(()=>P(l,` ${s($).gitBranch??""}`)),o(k,v)},$$slots:{default:!0}})};F(q,i=>{s($)?.gitBranch&&i(R)})}var de=r(q,2);{var ce=i=>{me(i,{variant:"outline",class:"flex gap-1 items-center",children:(k,c)=>{var v=pt(),L=f(v);Ze(L,{size:14});var l=r(L);D(()=>P(l,` Port ${s($).port??""}`)),o(k,v)},$$slots:{default:!0}})};F(de,i=>{s($)?.port&&i(ce)})}var Z=r(de,2);{var ee=i=>{me(i,{variant:"outline",class:"flex gap-1 items-center",children:(k,c)=>{var v=ut(),L=f(v);st(L,{size:14});var l=r(L);D(()=>P(l,` ${s($).runtime??""}`)),o(k,v)},$$slots:{default:!0}})};F(Z,i=>{s($)?.runtime&&i(ee)})}a(H),a(x);var ve=r(x,2),pe=t(ve);V(pe,{variant:"outline",size:"sm",onclick:Ce,children:(i,k)=>{var c=ft(),v=f(c);ot(v,{size:16,class:"mr-2"}),M(),o(i,c)},$$slots:{default:!0}});var ue=r(pe,2);V(ue,{variant:"outline",size:"sm",onclick:()=>he("restart"),get disabled(){return s(z)},children:(i,k)=>{var c=mt(),v=f(c);lt(v,{size:16,class:"mr-2"}),M(),o(i,c)},$$slots:{default:!0}});var te=r(ue,2);V(te,{variant:"outline",size:"sm",onclick:()=>he("stop"),get disabled(){return s(z)},children:(i,k)=>{var c=_t(),v=f(c);We(v,{size:16,class:"mr-2"}),M(),o(i,c)},$$slots:{default:!0}});var K=r(te,2);V(K,{variant:"outline",size:"sm",onclick:()=>he("start"),get disabled(){return s(z)},children:(i,k)=>{var c=$t(),v=f(c);Ye(v,{size:16,class:"mr-2"}),M(),o(i,c)},$$slots:{default:!0}});var ye=r(K,2);V(ye,{variant:"destructive",size:"sm",onclick:()=>{d(X,!0),d(ze,{type:"app"},!0)},children:(i,k)=>{var c=ht(),v=f(c);it(v,{size:16,class:"mr-2"}),M(),o(i,c)},$$slots:{default:!0}}),a(ve),D(()=>P(J,y)),o(w,B)},$$slots:{default:!0}});var g=r(_,2),G=r(t(g),2),E=t(G);Xe(E,17,()=>s(m),Je,(w,u)=>{{let B=Oe(()=>s(u).isCurrent?"border-2 border-[var(--primary)]":"");ae(w,{get class(){return`flex items-center justify-between !p-4 ${s(B)??""}`},children:(x,O)=>{var J=Pt(),H=f(J),q=t(H);{var R=l=>{var b=xt(),U=t(b);tt(U,{size:18}),a(b),o(l,b)},de=l=>{var b=yt(),U=t(b,!0);a(b),D(()=>P(U,s(u).id)),o(l,b)};F(q,l=>{s(u).isCurrent?l(R):l(de,!1)})}var ce=r(q,2),Z=t(ce),ee=t(Z),ve=t(ee);a(ee);var pe=r(ee,2);{var ue=l=>{me(l,{variant:"success",children:(b,U)=>{M();var Q=fe("Current");o(b,Q)},$$slots:{default:!0}})};F(pe,l=>{s(u).isCurrent&&l(ue)})}a(Z);var te=r(Z,2),K=t(te),ye=t(K,!0);a(K);var i=r(K,2);{var k=l=>{var b=bt(),U=t(b,!0);a(b),D(Q=>P(U,Q),[()=>s(u).commitHash.slice(0,7)]),o(l,b)};F(i,l=>{s(u).commitHash&&l(k)})}a(te),a(ce),a(H);var c=r(H,2),v=t(c);{var L=l=>{V(l,{variant:"outline",size:"sm",onclick:()=>ke(s(u).id),get disabled(){return s(z)},children:(b,U)=>{var Q=wt(),Re=f(Q);at(Re,{size:16,class:"mr-2"}),M(),o(b,Q)},$$slots:{default:!0}})};F(v,l=>{s(u).isCurrent||l(L)})}a(c),D(l=>{P(ve,`v${s(u).id??""}`),P(ye,l)},[()=>Ne(s(u).deployedAt)]),o(x,J)},$$slots:{default:!0}})}});var S=r(E,2);{var Y=w=>{ae(w,{class:"p-8 text-center text-[var(--text-secondary)]",children:(u,B)=>{M();var x=fe("No deployments found for this app");o(u,x)},$$slots:{default:!0}})};F(S,w=>{s(m).length===0&&w(Y)})}a(G),a(g),o(e,n)};F(De,e=>{s(_e)?e(Fe):e(He,!1)})}a(ge);var Me=r(ge,2);{var Le=e=>{var n=zt();n.__click=()=>d(W,!1),n.__keydown=x=>x.key==="Escape"&&d(W,!1);var _=t(n);_.__click=x=>x.stopPropagation(),_.__keydown=x=>x.stopPropagation();var g=t(_),G=t(g),E=t(G);a(G);var S=r(G,2);S.__click=()=>d(W,!1);var Y=t(S);et(Y,{size:24}),a(S),a(g);var w=r(g,2),u=t(w),B=t(u,!0);a(u),a(w),a(_),a(n),D(()=>{P(E,`Logs - ${y??""}`),P(B,s(be))}),o(e,n)};F(Me,e=>{s(W)&&e(Le)})}var Se=r(Me,2);{var Be=e=>{var n=Ct();n.__click=()=>d(X,!1),n.__keydown=g=>g.key==="Escape"&&d(X,!1);var _=t(n);ae(_,{class:"w-full max-w-md",onclick:g=>g.stopPropagation(),children:(g,G)=>{var E=kt(),S=f(E),Y=t(S);rt(Y,{size:20}),M(),a(S);var w=r(S,2),u=r(t(w)),B=t(u,!0);a(u),M(),a(w);var x=r(w,2),O=t(x);V(O,{variant:"outline",onclick:()=>d(X,!1),children:(H,q)=>{M();var R=fe("Cancel");o(H,R)},$$slots:{default:!0}});var J=r(O,2);V(J,{variant:"destructive",onclick:Ae,get disabled(){return s(z)},children:(H,q)=>{M();var R=fe();D(()=>P(R,s(z)?"Deleting...":"Delete App")),o(H,R)},$$slots:{default:!0}}),a(x),D(()=>P(B,y)),o(g,E)},$$slots:{default:!0}}),a(n),o(e,n)};F(Se,e=>{s(X)&&e(Be)})}D(()=>P(je,y)),o(C,we),Ee(),j()}Te(["click","keydown"]);export{Xt as component,Ut as universal};
