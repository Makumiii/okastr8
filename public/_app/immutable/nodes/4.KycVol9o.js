import{d as Se,f as P,a as l,s as x,t as $}from"../chunks/ISW6cSpQ.js";import{o as Fe}from"../chunks/CcMilK9m.js";import{p as Ne,b as A,h as Re,f as K,t as w,a as Te,s as n,d as a,c as o,r,g as t,n as p,u as Ee}from"../chunks/D5eA8VJ5.js";import{s as He,i as k,a as Me}from"../chunks/D7wiL91P.js";import{e as Oe,i as Ve}from"../chunks/r52qgGaC.js";import{p as Ue}from"../chunks/mmOYl5Vi.js";import{B}from"../chunks/Bh4T3gSW.js";import{C as Q}from"../chunks/CLc_SRGS.js";import{B as ae}from"../chunks/B5ufFMg8.js";import{p as W,g as qe}from"../chunks/BDoOvnV6.js";import{t as L}from"../chunks/PuVCaejm.js";const Ge=!1,ft=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ge},Symbol.toStringTag,{value:"Module"}));var Ie=P('<div class="h-8 w-48 rounded bg-[var(--border)]"></div> <div class="mt-4 h-4 w-64 rounded bg-[var(--border)]"></div>',1),Je=P('<div><h1 class="text-2xl font-bold text-[var(--text-primary)]"> </h1> <div class="mt-2 flex flex-wrap items-center gap-2"><!> <!> <!></div></div> <div class="flex flex-wrap gap-2"><!> <!> <!> <!> <!></div>',1),Ke=P('<span class="flex h-8 w-8 items-center justify-center rounded-full bg-[var(--success-light)] text-[var(--success)]">‚úì</span>'),Qe=P('<span class="flex h-8 w-8 items-center justify-center rounded-full bg-[var(--bg-sidebar)] text-[var(--text-muted)]"> </span>'),We=P('<span class="font-mono"> </span>'),Xe=P('<div class="flex items-center gap-4"><!> <div><div class="flex items-center gap-2"><span class="font-medium text-[var(--text-primary)]"> </span> <!></div> <div class="mt-1 flex items-center gap-3 text-xs text-[var(--text-muted)]"><span> </span> <!></div></div></div> <div class="flex items-center gap-2"><!></div>',1),Ye=P('<!> <div><h2 class="mb-4 text-lg font-semibold text-[var(--text-primary)]">Deployments</h2> <div class="space-y-3"><!> <!></div></div>',1),Ze=P('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4" role="button" tabindex="0"><div class="max-h-[80vh] w-full max-w-4xl overflow-hidden rounded-[var(--radius-lg)] bg-white shadow-xl" role="document" tabindex="-1"><div class="flex items-center justify-between border-b border-[var(--border)] p-4"><h3 class="text-lg font-semibold text-[var(--text-primary)]"> </h3> <button class="text-2xl text-[var(--text-muted)] hover:text-[var(--text-primary)]">√ó</button></div> <div class="max-h-[60vh] overflow-auto bg-[var(--bg-terminal)] p-4"><pre class="whitespace-pre-wrap font-mono text-sm text-green-400"> </pre></div></div></div>'),et=P(`<h3 class="text-lg font-semibold text-[var(--error)]">‚ö†Ô∏è Confirm Deletion</h3> <p class="mt-2 text-[var(--text-secondary)]">Are you sure you want to delete <strong> </strong>? This
                action cannot be undone.</p> <div class="mt-4 flex justify-end gap-3"><!> <!></div>`,1),tt=P('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4" role="button" tabindex="0"><!></div>'),at=P('<div class="space-y-6"><div class="flex items-center gap-2 text-sm text-[var(--text-secondary)]"><a href="/apps" class="hover:text-[var(--primary)]">Apps</a> <span>‚Üí</span> <span class="font-medium text-[var(--text-primary)]"> </span></div> <!></div> <!> <!>',1);function mt(me,_e){Ne(_e,!0);const xe=()=>He(Ue,"$page",$e),[$e,ge]=Me(),C=xe().params.name;let re=A(Re([])),S=A(null),ce=A(""),se=A(!0),g=A(!1),O=A(!1),E=A(!1),he=A(null);Fe(async()=>{await oe()});async function oe(){n(se,!0);try{const e=await W("/app/versions",{name:C});e.success&&e.data&&n(re,e.data,!0);const s=await qe("/app/list");s.success&&s.data?.apps&&n(S,s.data.apps.find(h=>h.name===C)||null,!0)}catch{L.error("Failed to load app data")}n(se,!1)}async function le(e){n(g,!0);const s=await W(`/app/${e}`,{name:C});s.success?(L.success(`App ${e}ed successfully`),await oe()):L.error(s.message||`Failed to ${e} app`),n(g,!1)}async function be(e){n(g,!0);const s=await W("/app/rollback",{name:C,versionId:e});s.success?(L.success("Version promoted successfully"),await oe()):L.error(s.message||"Failed to promote version"),n(g,!1)}async function ye(){const e=await W("/app/logs",{name:C,lines:100});e.success?(n(ce,e.message||"No logs available",!0),n(O,!0)):L.error("Failed to load logs")}async function we(){n(g,!0);const e=await W("/app/delete",{name:C});e.success?(L.success("App deleted"),window.location.href="/apps"):L.error(e.message||"Failed to delete app"),n(g,!1),n(E,!1)}function ke(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}var pe=at(),ie=K(pe),ne=a(ie),ue=o(a(ne),4),Pe=a(ue,!0);r(ue),r(ne);var Ce=o(ne,2);{var je=e=>{Q(e,{class:"animate-pulse p-8",children:(s,h)=>{var u=Ie();p(2),l(s,u)},$$slots:{default:!0}})},ze=e=>{var s=Ye(),h=K(s);Q(h,{class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:(f,d)=>{var m=Je(),z=K(m),D=a(z),H=a(D,!0);r(D);var y=o(D,2),V=a(y);{var de=i=>{ae(i,{variant:"outline",children:(b,c)=>{p();var j=$();w(()=>x(j,`üåø ${t(S).gitBranch??""}`)),l(b,j)},$$slots:{default:!0}})};k(V,i=>{t(S)?.gitBranch&&i(de)})}var X=o(V,2);{var Y=i=>{ae(i,{variant:"outline",children:(b,c)=>{p();var j=$();w(()=>x(j,`üì° Port ${t(S).port??""}`)),l(b,j)},$$slots:{default:!0}})};k(X,i=>{t(S)?.port&&i(Y)})}var U=o(X,2);{var q=i=>{ae(i,{variant:"outline",children:(b,c)=>{p();var j=$();w(()=>x(j,`‚öôÔ∏è ${t(S).runtime??""}`)),l(b,j)},$$slots:{default:!0}})};k(U,i=>{t(S)?.runtime&&i(q)})}r(y),r(z);var Z=o(z,2),ee=a(Z);B(ee,{variant:"outline",size:"sm",onclick:ye,children:(i,b)=>{p();var c=$("üìã Logs");l(i,c)},$$slots:{default:!0}});var te=o(ee,2);B(te,{variant:"outline",size:"sm",onclick:()=>le("restart"),get disabled(){return t(g)},children:(i,b)=>{p();var c=$("üîÑ Restart");l(i,c)},$$slots:{default:!0}});var G=o(te,2);B(G,{variant:"outline",size:"sm",onclick:()=>le("stop"),get disabled(){return t(g)},children:(i,b)=>{p();var c=$("‚èπÔ∏è Stop");l(i,c)},$$slots:{default:!0}});var M=o(G,2);B(M,{variant:"outline",size:"sm",onclick:()=>le("start"),get disabled(){return t(g)},children:(i,b)=>{p();var c=$("‚ñ∂Ô∏è Start");l(i,c)},$$slots:{default:!0}});var ve=o(M,2);B(ve,{variant:"destructive",size:"sm",onclick:()=>{n(E,!0),n(he,{type:"app"},!0)},children:(i,b)=>{p();var c=$("üóëÔ∏è Delete");l(i,c)},$$slots:{default:!0}}),r(Z),w(()=>x(H,C)),l(f,m)},$$slots:{default:!0}});var u=o(h,2),F=o(a(u),2),N=a(F);Oe(N,17,()=>t(re).sort((f,d)=>d.id-f.id),Ve,(f,d)=>{{let m=Ee(()=>t(d).isCurrent?"border-2 border-[var(--primary)]":"");Q(f,{get class(){return`flex items-center justify-between !p-4 ${t(m)??""}`},children:(z,D)=>{var H=Xe(),y=K(H),V=a(y);{var de=v=>{var _=Ke();l(v,_)},X=v=>{var _=Qe(),I=a(_,!0);r(_),w(()=>x(I,t(d).id)),l(v,_)};k(V,v=>{t(d).isCurrent?v(de):v(X,!1)})}var Y=o(V,2),U=a(Y),q=a(U),Z=a(q);r(q);var ee=o(q,2);{var te=v=>{ae(v,{variant:"success",children:(_,I)=>{p();var J=$("Current");l(_,J)},$$slots:{default:!0}})};k(ee,v=>{t(d).isCurrent&&v(te)})}r(U);var G=o(U,2),M=a(G),ve=a(M,!0);r(M);var i=o(M,2);{var b=v=>{var _=We(),I=a(_,!0);r(_),w(J=>x(I,J),[()=>t(d).commitHash.slice(0,7)]),l(v,_)};k(i,v=>{t(d).commitHash&&v(b)})}r(G),r(Y),r(y);var c=o(y,2),j=a(c);{var Le=v=>{B(v,{variant:"outline",size:"sm",onclick:()=>be(t(d).id),get disabled(){return t(g)},children:(_,I)=>{p();var J=$("üöÄ Promote");l(_,J)},$$slots:{default:!0}})};k(j,v=>{t(d).isCurrent||v(Le)})}r(c),w(v=>{x(Z,`v${t(d).id??""}`),x(ve,v)},[()=>ke(t(d).deployedAt)]),l(z,H)},$$slots:{default:!0}})}});var R=o(N,2);{var T=f=>{Q(f,{class:"p-8 text-center text-[var(--text-secondary)]",children:(d,m)=>{p();var z=$("No deployments found for this app");l(d,z)},$$slots:{default:!0}})};k(R,f=>{t(re).length===0&&f(T)})}r(F),r(u),l(e,s)};k(Ce,e=>{t(se)?e(je):e(ze,!1)})}r(ie);var fe=o(ie,2);{var De=e=>{var s=Ze();s.__click=()=>n(O,!1),s.__keydown=m=>m.key==="Escape"&&n(O,!1);var h=a(s);h.__click=m=>m.stopPropagation(),h.__keydown=m=>m.stopPropagation();var u=a(h),F=a(u),N=a(F);r(F);var R=o(F,2);R.__click=()=>n(O,!1),r(u);var T=o(u,2),f=a(T),d=a(f,!0);r(f),r(T),r(h),r(s),w(()=>{x(N,`Logs - ${C??""}`),x(d,t(ce))}),l(e,s)};k(fe,e=>{t(O)&&e(De)})}var Ae=o(fe,2);{var Be=e=>{var s=tt();s.__click=()=>n(E,!1),s.__keydown=u=>u.key==="Escape"&&n(E,!1);var h=a(s);Q(h,{class:"w-full max-w-md",onclick:u=>u.stopPropagation(),children:(u,F)=>{var N=et(),R=o(K(N),2),T=o(a(R)),f=a(T,!0);r(T),p(),r(R);var d=o(R,2),m=a(d);B(m,{variant:"outline",onclick:()=>n(E,!1),children:(D,H)=>{p();var y=$("Cancel");l(D,y)},$$slots:{default:!0}});var z=o(m,2);B(z,{variant:"destructive",onclick:we,get disabled(){return t(g)},children:(D,H)=>{p();var y=$();w(()=>x(y,t(g)?"Deleting...":"Delete App")),l(D,y)},$$slots:{default:!0}}),r(d),w(()=>x(f,C)),l(u,N)},$$slots:{default:!0}}),r(s),l(e,s)};k(Ae,e=>{t(E)&&e(Be)})}w(()=>x(Pe,C)),l(me,pe),Te(),ge()}Se(["click","keydown"]);export{mt as component,ft as universal};
