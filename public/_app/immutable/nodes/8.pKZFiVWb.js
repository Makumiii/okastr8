import{c as ft,a as d,f as p,s as c,t as Xt}from"../chunks/BesHKk2l.js";import{o as Yt}from"../chunks/CMSYLF-L.js";import{f as b,p as Zt,s as Y,a as te,b as ee,c as Q,d as s,e as r,g as t,r as e,n as Ft,t as $,u as jt}from"../chunks/DcwGHiHW.js";import{l as re,s as ae,i as U}from"../chunks/VPZc6XJw.js";import{e as pt,i as ut}from"../chunks/D9-Fv5Cr.js";import{c as se}from"../chunks/Dj0jeNMx.js";import{a as B,f as xt}from"../chunks/sNASJAqg.js";import{C as S}from"../chunks/CcxZSFxj.js";import{g as oe,B as ie}from"../chunks/BhjZa1Ej.js";import{T as qt}from"../chunks/9JUkeufA.js";import{A as le}from"../chunks/ECDRYEVp.js";import"../chunks/BlO2upe1.js";import{I as de,s as ne}from"../chunks/BTbKrF2_.js";import{S as ve,P as ce}from"../chunks/BAuDmANa.js";function me(Z,V){const i=re(V,["children","$$slots","$$events","$$legacy"]);const I=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}],["path",{d:"M12 17h.01"}]];de(Z,ae({name:"circle-question-mark"},()=>i,{get iconNode(){return I},children:(W,T)=>{var z=ft(),F=b(z);ne(F,V,"default",{}),d(W,z)},$$slots:{default:!0}}))}var pe=p('<div class="h-32 w-32 rounded-full bg-[var(--border)]"></div> <div class="mt-4 h-4 w-20 rounded bg-[var(--border)]"></div>',1),ue=p('<div class="grid gap-6 md:grid-cols-3"></div>'),xe=p('<!> <p class="text-[var(--error)]"> </p>',1),fe=p('<div class="relative h-32 w-32"><svg class="h-full w-full -rotate-90" viewBox="0 0 100 100"><circle class="fill-none stroke-[var(--border)]" cx="50" cy="50" r="42" stroke-width="12"></circle><circle class="fill-none transition-all duration-500" cx="50" cy="50" r="42" stroke-width="12" stroke-linecap="round"></circle></svg> <div class="absolute inset-0 flex flex-col items-center justify-center"><span class="text-2xl font-bold text-[var(--text-primary)]"> </span></div></div> <h3 class="mt-4 text-lg font-semibold text-[var(--text-primary)]">CPU Usage</h3> <p class="text-sm text-[var(--text-secondary)]"> </p>',1),_e=p('<div class="relative h-32 w-32"><svg class="h-full w-full -rotate-90" viewBox="0 0 100 100"><circle class="fill-none stroke-[var(--border)]" cx="50" cy="50" r="42" stroke-width="12"></circle><circle class="fill-none transition-all duration-500" cx="50" cy="50" r="42" stroke-width="12" stroke-linecap="round"></circle></svg> <div class="absolute inset-0 flex flex-col items-center justify-center"><span class="text-2xl font-bold text-[var(--text-primary)]"> </span></div></div> <h3 class="mt-4 text-lg font-semibold text-[var(--text-primary)]">Memory</h3> <p class="text-sm text-[var(--text-secondary)]"> </p>',1),ge=p('<div class="relative h-32 w-32"><svg class="h-full w-full -rotate-90" viewBox="0 0 100 100"><circle class="fill-none stroke-[var(--border)]" cx="50" cy="50" r="42" stroke-width="12"></circle><circle class="fill-none transition-all duration-500" cx="50" cy="50" r="42" stroke-width="12" stroke-linecap="round"></circle></svg> <div class="absolute inset-0 flex flex-col items-center justify-center"><span class="text-2xl font-bold text-[var(--text-primary)]"> </span></div></div> <h3 class="mt-4 text-lg font-semibold text-[var(--text-primary)]">Disk</h3> <p class="text-sm text-[var(--text-secondary)]"> </p>',1),ye=p('<div class="rounded-[var(--radius-md)] bg-[var(--bg-sidebar)] p-4"><p class="text-sm text-[var(--text-secondary)]"> </p> <p class="mt-1 text-2xl font-bold text-[var(--text-primary)]"> </p></div>'),he=p('<h3 class="mb-4 text-lg font-semibold text-[var(--text-primary)]">System Load</h3> <div class="grid gap-4 md:grid-cols-3"></div>',1),$e=p('<div class="flex items-center justify-between"><div><p class="text-sm text-[var(--primary)]">Server Uptime</p> <p class="mt-1 text-2xl font-bold text-[var(--text-primary)]"> </p></div> <!></div>'),be=p('<span class="text-[var(--text-secondary)]"> </span>'),ke=p('<span class="text-[var(--text-primary)]"> <!></span>'),we=p('<div class="mt-4 pt-3 border-t border-[var(--border)]"><div class="flex items-center justify-between text-sm"><span class="text-[var(--text-secondary)] truncate max-w-[120px]"> </span> <!></div></div>'),Pe=p('<div class="mb-4 flex items-center justify-between"><div class="flex items-center gap-2"><!> <h3 class="font-semibold text-[var(--text-primary)] truncate max-w-[150px]"> </h3></div> <!></div> <div class="space-y-3"><div><div class="flex items-center justify-between text-sm mb-1"><span class="text-[var(--text-secondary)]">CPU</span> <span class="font-medium text-[var(--text-primary)]"> </span></div> <div class="h-2 w-full rounded-full bg-[var(--bg-sidebar)] overflow-hidden"><div class="h-full rounded-full transition-all duration-300"></div></div></div> <div><div class="flex items-center justify-between text-sm mb-1"><span class="text-[var(--text-secondary)]">Memory</span> <span class="font-medium text-[var(--text-primary)]"> </span></div> <div class="h-2 w-full rounded-full bg-[var(--bg-sidebar)] overflow-hidden"><div class="h-full rounded-full transition-all duration-300"></div></div></div> <div><div class="flex items-center justify-between text-sm mb-1"><span class="text-[var(--text-secondary)]">Disk</span> <span class="font-medium text-[var(--text-primary)]"> </span></div> <div class="h-2 w-full rounded-full bg-[var(--bg-primary)]"></div></div></div> <!>',1),Me=p('<div><h2 class="mb-4 text-xl font-semibold text-[var(--text-primary)]">Service Resource Usage</h2> <p class="mb-4 text-sm text-[var(--text-secondary)]">Per-application CPU, memory, and disk consumption</p></div> <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3"></div>',1),Be=p('<div class="grid gap-6 md:grid-cols-3"><!> <!> <!></div> <!> <!> <!>',1),Se=p('<div class="space-y-6"><div><h1 class="text-2xl font-bold text-[var(--text-primary)]">System Metrics</h1> <p class="mt-1 text-[var(--text-secondary)]">Real-time server performance monitoring</p></div> <!></div>');function Ke(Z,V){Zt(V,!0);let i=Y(null),I=Y(te([])),W=Y(!0),T=Y("");Yt(()=>{z();const o=setInterval(z,1e4);return()=>clearInterval(o)});async function z(){try{const o=await oe("/system/metrics");if(o.success&&o.data?.system){const n=o.data.system;Q(i,{cpu:n.cpu,memory:{used:n.memory.used*1024*1024,total:n.memory.total*1024*1024,usedPercent:n.memory.percent},disk:{used:n.disk.used,total:n.disk.total,usedPercent:n.disk.percent},uptime:n.uptimeSeconds,loadAvg:n.load},!0),Q(I,o.data.services||[],!0)}else Q(T,o.message||"Failed to load metrics",!0)}catch{Q(T,"Failed to connect to server")}finally{Q(W,!1)}}function F(o){if(o===0)return"0 B";const n=1024,L=["B","KB","MB","GB","TB"],N=Math.floor(Math.log(o)/Math.log(n));return parseFloat((o/Math.pow(n,N)).toFixed(1))+" "+L[N]}function D(o){return o<60?"var(--success)":o<85?"var(--warning)":"var(--error)"}function Ut(o){switch(o){case"running":return ce;case"stopped":return ve;case"failed":return qt;default:return me}}function Ct(o){return o.charAt(0).toUpperCase()+o.slice(1)}var tt=Se(),At=s(r(tt),2);{var It=o=>{var n=ue();pt(n,20,()=>Array(3),ut,(L,N)=>{S(L,{class:"flex animate-pulse flex-col items-center p-8",children:(et,j)=>{var C=pe();Ft(2),d(et,C)},$$slots:{default:!0}})}),e(n),d(o,n)},Tt=o=>{var n=ft(),L=b(n);{var N=j=>{S(j,{class:"bg-[var(--error-light)] flex items-center gap-2",children:(C,_t)=>{var X=xe(),A=b(X);qt(A,{class:"text-[var(--error)]"});var R=s(A,2),G=r(R,!0);e(R),$(()=>c(G,t(T))),d(C,X)},$$slots:{default:!0}})},et=j=>{var C=ft(),_t=b(C);{var X=A=>{var R=Be(),G=b(R),gt=r(G);S(gt,{class:"flex flex-col items-center p-8",children:(g,q)=>{var v=fe(),l=b(v),a=r(l),x=s(r(a));e(a);var f=s(a,2),u=r(f),_=r(u);e(u),e(f),e(l);var m=s(l,4),y=r(m);e(m),$((k,h)=>{B(x,"stroke",k),B(x,"stroke-dasharray",`${t(i).cpu.usage*2.64}, 264`),c(_,`${h??""}%`),c(y,`${t(i).cpu.cores??""} cores`)},[()=>D(t(i).cpu.usage),()=>t(i).cpu.usage.toFixed(0)]),d(g,v)},$$slots:{default:!0}});var yt=s(gt,2);S(yt,{class:"flex flex-col items-center p-8",children:(g,q)=>{var v=_e(),l=b(v),a=r(l),x=s(r(a));e(a);var f=s(a,2),u=r(f),_=r(u);e(u),e(f),e(l);var m=s(l,4),y=r(m);e(m),$((k,h,K,E)=>{B(x,"stroke",k),B(x,"stroke-dasharray",`${t(i).memory.usedPercent*2.64}, 264`),c(_,`${h??""}%`),c(y,`${K??""} / ${E??""}`)},[()=>D(t(i).memory.usedPercent),()=>t(i).memory.usedPercent.toFixed(0),()=>F(t(i).memory.used),()=>F(t(i).memory.total)]),d(g,v)},$$slots:{default:!0}});var zt=s(yt,2);S(zt,{class:"flex flex-col items-center p-8",children:(g,q)=>{var v=ge(),l=b(v),a=r(l),x=s(r(a));e(a);var f=s(a,2),u=r(f),_=r(u);e(u),e(f),e(l);var m=s(l,4),y=r(m);e(m),$((k,h,K,E)=>{B(x,"stroke",k),B(x,"stroke-dasharray",`${t(i).disk.usedPercent*2.64}, 264`),c(_,`${h??""}%`),c(y,`${K??""} / ${E??""}`)},[()=>D(t(i).disk.usedPercent),()=>t(i).disk.usedPercent.toFixed(0),()=>F(t(i).disk.used),()=>F(t(i).disk.total)]),d(g,v)},$$slots:{default:!0}}),e(G);var ht=s(G,2);S(ht,{children:(g,q)=>{var v=he(),l=s(b(v),2);pt(l,20,()=>[1,5,15],ut,(a,x,f)=>{var u=ye(),_=r(u),m=r(_);e(_);var y=s(_,2),k=r(y,!0);e(y),e(u),$(h=>{c(m,`${x??""} min avg`),c(k,h)},[()=>t(i).loadAvg[f]?.toFixed(2)||"0.00"]),d(a,u)}),e(l),d(g,v)},$$slots:{default:!0}});var $t=s(ht,2);S($t,{class:"bg-[var(--primary-light)]",children:(g,q)=>{var v=$e(),l=r(v),a=s(r(l),2),x=r(a);e(a),e(l);var f=s(l,2);le(f,{size:32,class:"text-[var(--primary)]"}),e(v),$((u,_,m)=>c(x,`${u??""}d ${_??""}h ${m??""}m`),[()=>Math.floor(t(i).uptime/86400),()=>Math.floor(t(i).uptime%86400/3600),()=>Math.floor(t(i).uptime%3600/60)]),d(g,v)},$$slots:{default:!0}});var Dt=s($t,2);{var Lt=g=>{var q=Me(),v=s(b(q),2);pt(v,21,()=>t(I),ut,(l,a)=>{const x=jt(()=>Ut(t(a).status));S(l,{class:"p-4",children:(f,u)=>{var _=Pe(),m=b(_),y=r(m),k=r(y);se(k,()=>t(x),(w,P)=>{P(w,{size:24})});var h=s(k,2),K=r(h,!0);e(h),e(y);var E=s(y,2);{let w=jt(()=>t(a).status==="running"?"success":t(a).status==="stopped"?"error":"warning");ie(E,{get variant(){return t(w)},children:(P,H)=>{Ft();var M=Xt();$(J=>c(M,J),[()=>t(a).uptime||Ct(t(a).status)]),d(P,M)},$$slots:{default:!0}})}e(m);var rt=s(m,2),at=r(rt),st=r(at),bt=s(r(st),2),Nt=r(bt);e(bt),e(st);var kt=s(st,2),Rt=r(kt);e(kt),e(at);var ot=s(at,2),it=r(ot),wt=s(r(it),2),Gt=r(wt);e(wt),e(it);var Pt=s(it,2),Kt=r(Pt);e(Pt),e(ot);var Mt=s(ot,2),lt=r(Mt),Bt=s(r(lt),2),Et=r(Bt,!0);e(Bt),e(lt);var Ht=s(lt,2);e(Mt),e(rt);var Jt=s(rt,2);{var Ot=w=>{var P=we(),H=r(P),M=r(H),J=r(M,!0);e(M);var dt=s(M,2);{var nt=O=>{var vt=ke(),St=r(vt),Qt=s(St);{var Vt=ct=>{var mt=be(),Wt=r(mt);e(mt),$(()=>c(Wt,`(${t(a).requestsPerSec??""}/s)`)),d(ct,mt)};U(Qt,ct=>{t(a).requestsPerSec!==void 0&&t(a).requestsPerSec>0&&ct(Vt)})}e(vt),$(()=>c(St,`${t(a).requestsTotal??""} reqs `)),d(O,vt)};U(dt,O=>{t(a).requestsTotal!==void 0&&O(nt)})}e(H),e(P),$(()=>{B(M,"title",t(a).domain),c(J,t(a).domain)}),d(w,P)};U(Jt,w=>{t(a).domain&&w(Ot)})}$((w,P,H,M,J,dt,nt,O)=>{B(h,"title",t(a).name),c(K,t(a).name),c(Nt,`${w??""}%`),xt(Rt,`width: ${P??""}%; background-color: ${H??""}`),c(Gt,`${t(a).memory??""} MB (${M??""}%)`),xt(Kt,`width: ${J??""}%; background-color: ${dt??""}`),c(Et,nt),xt(Ht,`width: ${O??""}%`)},[()=>t(a).cpu.toFixed(1),()=>Math.min(t(a).cpu,100),()=>D(t(a).cpu),()=>t(a).memoryPercent.toFixed(1),()=>Math.min(t(a).memoryPercent,100),()=>D(t(a).memoryPercent),()=>F(t(a).diskUsage),()=>Math.min(t(a).diskUsage/1073741824*100,100)]),d(f,_)},$$slots:{default:!0}})}),e(v),d(g,q)};U(Dt,g=>{t(I).length>0&&g(Lt)})}d(A,R)};U(_t,A=>{t(i)&&A(X)},!0)}d(j,C)};U(L,j=>{t(T)?j(N):j(et,!1)},!0)}d(o,n)};U(At,o=>{t(W)?o(It):o(Tt,!1)})}e(tt),d(Z,tt),ee()}export{Ke as component};
